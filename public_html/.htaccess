RewriteEngine On
RewriteBase /

# Dynamic error handling - captures first directory segment
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_URI} ^(/[^/]+)/
RewriteRule . %1/error.php?code=404 [R=302,L]

# Fallback for root-level requests
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^[^/]*$ /error.php?code=404 [R=302,L]
